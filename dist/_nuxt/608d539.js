(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{316:function(e,t,r){e.exports=r.p+"img/default-album.c4b3b71.png"},323:function(e,t,r){"use strict";var n=[function(){var e=this._self._c;return e("div",{staticClass:"mb-8"},[e("img",{staticClass:"h-16 mx-auto drop-shadow-lg",attrs:{src:r(331),alt:"Spotify Logo"}})])}],o={name:"Sidebar"},c=(r(332),r(49)),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return t("aside",{staticClass:"w-64 bg-gradient-to-b from-black via-[#2d0036] to-[#1a0022] p-4 min-h-screen shadow-2xl border-r border-pink-900"},[e._m(0),e._v(" "),t("nav",[t("ul",[t("li",{staticClass:"mb-4"},[t("nuxt-link",{staticClass:"flex items-center text-pink-200 hover:text-pink-400 font-bold transition-colors duration-200",attrs:{to:"/",exact:"","active-class":"text-pink-400"}},[t("span",{staticClass:"material-icons mr-4 text-pink-400"},[e._v("home")]),e._v("\n          Accueil\n        ")])],1),e._v(" "),t("li",{staticClass:"mb-4"},[t("nuxt-link",{staticClass:"flex items-center text-pink-200 hover:text-pink-400 font-bold transition-colors duration-200",attrs:{to:"/dashboard","active-class":"text-pink-400"}},[t("span",{staticClass:"material-icons mr-4 text-pink-400"},[e._v("search")]),e._v("\n          Rechercher\n        ")])],1),e._v(" "),t("li",{staticClass:"mb-4"},[t("nuxt-link",{staticClass:"flex items-center text-pink-200 hover:text-pink-400 font-bold transition-colors duration-200",attrs:{to:"/library","active-class":"text-pink-400"}},[t("span",{staticClass:"material-icons mr-4 text-pink-400"},[e._v("library_music")]),e._v("\n          Votre BibliothÃ¨que\n        ")])],1)])])])}),n,!1,null,"eaaee124",null);t.a=component.exports},325:function(e,t,r){var content=r(333);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(92).default)("85f0e516",content,!0,{sourceMap:!1})},329:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(14);r(69),r(16),r(42),r(43),r(221);function o(){return c.apply(this,arguments)}function c(){return(c=Object(n.a)(regeneratorRuntime.mark((function e(){var t,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("spotify_refresh_token")){e.next=3;break}throw new Error("No refresh token available");case 3:return e.prev=3,e.next=6,fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:t,client_id:"cd0a66c293314bce91e0810930117a0f",client_secret:"e5f05c8775f44f9f8fce13dcd499ea74"})});case 6:return r=e.sent,e.next=9,r.json();case 9:if(data=e.sent,r.ok){e.next=12;break}throw new Error(data.error_description||"Failed to refresh token");case 12:return localStorage.setItem("spotify_access_token",data.access_token),data.refresh_token&&localStorage.setItem("spotify_refresh_token",data.refresh_token),localStorage.setItem("spotify_token_expires_at",Date.now()+1e3*data.expires_in),e.abrupt("return",data.access_token);case 18:throw e.prev=18,e.t0=e.catch(3),console.error("Error refreshing token:",e.t0),e.t0;case 22:case"end":return e.stop()}}),e,null,[[3,18]])})))).apply(this,arguments)}function l(){return d.apply(this,arguments)}function d(){return(d=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=void 0,(t=localStorage.getItem("spotify_token_expires_at"))&&!(Date.now()>parseInt(t))){e.next=4;break}return e.next=3,o();case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",localStorage.getItem("spotify_access_token"));case 5:case"end":return e.stop()}var t}),e)})))).apply(this,arguments)}},330:function(e,t,r){"use strict";r(35);var n=r(14),o=r(25),c=(r(69),r(73),r(53),r(16),r(32),r(36),r(41),r(70),r(71),r(51),r(336),r(42),r(337),r(338),r(339),r(340),r(341),r(342),r(343),r(344),r(345),r(346),r(347),r(348),r(349),r(350),r(351),r(352),r(353),r(31),r(43),r(74)),l=r(329);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v={name:"PlayerBar",data:function(){return{currentTrack:null,isPlaying:!1,currentTime:0,duration:0,volume:50,isMuted:!1,previousVolume:50,likedTracksIds:new Set,player:null,isPlayerReady:!1}},computed:{volumeIcon:function(){return this.isMuted||0===this.volume?"volume_off":this.volume<30?"volume_down":(this.volume,"volume_up")}},mounted:function(){this.loadLikedTracks(),this.initializePlayer()},beforeDestroy:function(){this.player&&this.player.disconnect()},methods:f(f({},Object(c.c)(["setDeviceId"])),{},{loadLikedTracks:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.a)();case 3:if(r=t.sent){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,e.$axios.$get("https://api.spotify.com/v1/me/tracks",{headers:{Authorization:"Bearer ".concat(r)}});case 8:n=t.sent,e.likedTracksIds=new Set(n.items.map((function(e){return e.track.id}))),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Error loading liked tracks:",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},initializePlayer:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,script;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.a)();case 3:if(r=t.sent){t.next=7;break}return console.error("No access token found"),t.abrupt("return");case 7:console.log("Initializing Spotify player..."),window.Spotify?(console.log("Spotify Web Playback SDK already loaded"),e.setupPlayer(r)):(console.log("Loading Spotify Web Playback SDK..."),(script=document.createElement("script")).src="https://sdk.scdn.co/spotify-player.js",script.async=!0,document.body.appendChild(script),window.onSpotifyWebPlaybackSDKReady=function(){console.log("Spotify Web Playback SDK ready"),e.setupPlayer(r)}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error initializing player:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},setupPlayer:function(e){var t,r=this;console.log("Setting up Spotify player..."),this.player=new Spotify.Player({name:"Spotify Clone Player",getOAuthToken:(t=Object(n.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Getting OAuth token..."),e.next=4,Object(l.a)();case 4:n=e.sent,t(n),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error getting OAuth token:",e.t0),r.$router.push("/login");case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(e){return t.apply(this,arguments)}),volume:.5}),this.player.addListener("initialization_error",(function(e){var t=e.message;console.error("Failed to initialize:",t)})),this.player.addListener("authentication_error",function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.message,console.error("Failed to authenticate:",n),e.prev=2,e.next=5,Object(l.a)();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Error refreshing token:",e.t0),r.$router.push("/login");case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()),this.player.addListener("account_error",(function(e){var t=e.message;console.error("Failed to validate Spotify account:",t)})),this.player.addListener("playback_error",(function(e){var t=e.message;console.error("Failed to perform playback:",t)})),this.player.addListener("ready",(function(e){var t=e.device_id;console.log("Player is ready with device ID:",t),r.setDeviceId(t),localStorage.setItem("spotify_device_id",t),r.isPlayerReady=!0,r.$emit("player-ready",t)})),this.player.addListener("not_ready",(function(e){var t=e.device_id;console.log("Player is not ready:",t),r.isPlayerReady=!1,r.$emit("player-not-ready")})),this.player.addListener("player_state_changed",(function(e){if(console.log("Player state changed:",e),e){var t,n,track=e.track_window.current_track;r.currentTrack={id:track.id,name:track.name,artist:null===(t=track.artists[0])||void 0===t?void 0:t.name,albumCover:null===(n=track.album.images[0])||void 0===n?void 0:n.url},r.isPlaying=!e.paused,r.duration=e.duration/1e3,r.currentTime=e.position/1e3,r.$emit("player-state-changed",e)}else console.log("No player state available"),r.currentTrack=null,r.isPlaying=!1,r.$emit("player-state-changed",null)})),console.log("Connecting to Spotify..."),this.player.connect().then((function(e){e?console.log("Successfully connected to Spotify!"):console.error("Failed to connect to Spotify")})).catch((function(e){console.error("Error connecting to Spotify:",e)}))},togglePlayback:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isPlayerReady){t.next=3;break}return console.log("Player not ready yet"),t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(l.a)();case 6:if(r=t.sent,n=localStorage.getItem("spotify_device_id"),r&&n){t.next=10;break}return t.abrupt("return");case 10:if(!e.isPlaying){t.next=15;break}return t.next=13,e.$axios.$put("https://api.spotify.com/v1/me/player/pause?device_id=".concat(n),{},{headers:{Authorization:"Bearer ".concat(r)}});case 13:t.next=17;break;case 15:return t.next=17,e.$axios.$put("https://api.spotify.com/v1/me/player/play?device_id=".concat(n),{},{headers:{Authorization:"Bearer ".concat(r)}});case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(3),console.error("Error toggling playback:",t.t0);case 22:case"end":return t.stop()}}),t,null,[[3,19]])})))()},previousTrack:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isPlayerReady){t.next=3;break}return console.log("Player not ready yet"),t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(l.a)();case 6:if(r=t.sent,n=localStorage.getItem("spotify_device_id"),r&&n){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,e.$axios.$post("https://api.spotify.com/v1/me/player/previous?device_id=".concat(n),{},{headers:{Authorization:"Bearer ".concat(r)}});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),console.error("Error playing previous track:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,14]])})))()},nextTrack:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isPlayerReady){t.next=3;break}return console.log("Player not ready yet"),t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(l.a)();case 6:if(r=t.sent,n=localStorage.getItem("spotify_device_id"),r&&n){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,e.$axios.$post("https://api.spotify.com/v1/me/player/next?device_id=".concat(n),{},{headers:{Authorization:"Bearer ".concat(r)}});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),console.error("Error playing next track:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,14]])})))()},seekTo:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,c,d,f,v,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.isPlayerReady){r.next=3;break}return console.log("Player not ready yet"),r.abrupt("return");case 3:return r.prev=3,r.next=6,Object(l.a)();case 6:if(n=r.sent,o=localStorage.getItem("spotify_device_id"),n&&o){r.next=10;break}return r.abrupt("return");case 10:return c=e.currentTarget,d=e.offsetX,f=c.offsetWidth,v=d/f,m=Math.floor(t.duration*v),r.next=17,t.$axios.$put("https://api.spotify.com/v1/me/player/seek?position_ms=".concat(1e3*m,"&device_id=").concat(o),{},{headers:{Authorization:"Bearer ".concat(n)}});case 17:r.next=22;break;case 19:r.prev=19,r.t0=r.catch(3),console.error("Error seeking:",r.t0);case 22:case"end":return r.stop()}}),r,null,[[3,19]])})))()},setVolume:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isPlayerReady){t.next=3;break}return console.log("Player not ready yet"),t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(l.a)();case 6:if(r=t.sent,n=localStorage.getItem("spotify_device_id"),r&&n){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,e.$axios.$put("https://api.spotify.com/v1/me/player/volume?volume_percent=".concat(e.volume,"&device_id=").concat(n),{},{headers:{Authorization:"Bearer ".concat(r)}});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),console.error("Error setting volume:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[3,14]])})))()},toggleMute:function(){this.isMuted?(this.volume=this.previousVolume,this.isMuted=!1):(this.previousVolume=this.volume,this.volume=0,this.isMuted=!0),this.setVolume()},formatTime:function(e){var t=Math.floor(e/60),r=Math.floor(e%60);return"".concat(t,":").concat(r.toString().padStart(2,"0"))},isTrackLiked:function(e){return this.likedTracksIds.has(e)},toggleLike:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(l.a)();case 3:if(n=r.sent){r.next=6;break}return r.abrupt("return");case 6:if(!t.isTrackLiked(e)){r.next=12;break}return r.next=9,t.$axios.$delete("https://api.spotify.com/v1/me/tracks?ids=".concat(e),{headers:{Authorization:"Bearer ".concat(n)}});case 9:t.likedTracksIds.delete(e),r.next=15;break;case 12:return r.next=14,t.$axios.$put("https://api.spotify.com/v1/me/tracks?ids=".concat(e),{},{headers:{Authorization:"Bearer ".concat(n)}});case 14:t.likedTracksIds.add(e);case 15:r.next=20;break;case 17:r.prev=17,r.t0=r.catch(0),console.error("Error toggling like:",r.t0);case 20:case"end":return r.stop()}}),r,null,[[0,17]])})))()}})},m=v,k=(r(382),r(49)),component=Object(k.a)(m,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"fixed bottom-0 left-0 right-0 bg-gradient-to-r from-black via-[#2d0036] to-[#1a0022] p-4 flex items-center border-t border-pink-900 shadow-2xl"},[t("div",{staticClass:"flex items-center w-1/3"},[e.currentTrack?t("img",{staticClass:"w-16 h-16 object-cover mr-4 rounded shadow-lg border-2 border-pink-400",attrs:{src:e.currentTrack.albumCover||r(316),alt:e.currentTrack.name}}):e._e(),e._v(" "),e.currentTrack?t("div",{staticClass:"flex-1"},[t("p",{staticClass:"text-pink-100 font-semibold"},[e._v(e._s(e.currentTrack.name))]),e._v(" "),t("p",{staticClass:"text-pink-300"},[e._v(e._s(e.currentTrack.artist))])]):e._e(),e._v(" "),e.currentTrack?t("button",{staticClass:"text-pink-400 hover:text-pink-200 transition-colors duration-200 ml-4",class:{"text-pink-500":e.isTrackLiked(e.currentTrack.id)},on:{click:function(t){return e.toggleLike(e.currentTrack.id)}}},[t("i",{staticClass:"material-icons"},[e._v(e._s(e.isTrackLiked(e.currentTrack.id)?"favorite":"favorite_border"))])]):t("div",{staticClass:"text-pink-300"},[e._v("\n      Aucune piste en cours de lecture\n    ")])]),e._v(" "),t("div",{staticClass:"flex flex-col items-center w-1/3"},[t("div",{staticClass:"flex items-center space-x-4 mb-2"},[t("button",{staticClass:"text-pink-300 hover:text-pink-100 transition-colors duration-200",on:{click:e.previousTrack}},[t("i",{staticClass:"material-icons"},[e._v("skip_previous")])]),e._v(" "),t("button",{staticClass:"text-pink-100 hover:text-pink-400 transition-colors duration-200",on:{click:e.togglePlayback}},[t("i",{staticClass:"material-icons text-3xl"},[e._v(e._s(e.isPlaying?"pause_circle_filled":"play_circle_filled"))])]),e._v(" "),t("button",{staticClass:"text-pink-300 hover:text-pink-100 transition-colors duration-200",on:{click:e.nextTrack}},[t("i",{staticClass:"material-icons"},[e._v("skip_next")])])]),e._v(" "),t("div",{staticClass:"w-full flex items-center space-x-2"},[t("span",{staticClass:"text-xs text-pink-300"},[e._v(e._s(e.formatTime(e.currentTime)))]),e._v(" "),t("div",{staticClass:"flex-1 h-1 bg-pink-900 rounded-full cursor-pointer",on:{click:e.seekTo}},[t("div",{staticClass:"h-full bg-pink-400 rounded-full",style:{width:"".concat(e.currentTime/e.duration*100,"%")}})]),e._v(" "),t("span",{staticClass:"text-xs text-pink-300"},[e._v(e._s(e.formatTime(e.duration)))])])]),e._v(" "),t("div",{staticClass:"flex items-center justify-end w-1/3 space-x-4"},[t("button",{staticClass:"text-pink-300 hover:text-pink-100 transition-colors duration-200",on:{click:e.toggleMute}},[t("i",{staticClass:"material-icons"},[e._v(e._s(e.volumeIcon))])]),e._v(" "),t("div",{staticClass:"flex items-center space-x-2 w-32"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.volume,expression:"volume"}],staticClass:"w-full h-1 bg-pink-900 rounded-full appearance-none cursor-pointer accent-pink-400",attrs:{type:"range",min:"0",max:"100"},domProps:{value:e.volume},on:{input:e.setVolume,__r:function(t){e.volume=t.target.value}}})])])])}),[],!1,null,"7113ddcb",null);t.a=component.exports},331:function(e,t,r){e.exports=r.p+"img/logo-spotify.a162f1e.png"},332:function(e,t,r){"use strict";r(325)},333:function(e,t,r){var n=r(91)((function(i){return i[1]}));n.push([e.i,'.material-icons[data-v-eaaee124]{display:inline-block;font-family:"Material Icons";font-size:24px;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1;text-transform:none;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased;transition:color .2s}.nuxt-link-exact-active[data-v-eaaee124]{color:#f472b6!important}',""]),n.locals={},e.exports=n},354:function(e,t,r){var content=r(383);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(92).default)("2d7d0ad8",content,!0,{sourceMap:!1})},382:function(e,t,r){"use strict";r(354)},383:function(e,t,r){var n=r(91)((function(i){return i[1]}));n.push([e.i,'.material-icons[data-v-7113ddcb]{display:inline-block;font-family:"Material Icons";font-size:24px;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1;text-transform:none;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}input[type=range][data-v-7113ddcb]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent}input[type=range][data-v-7113ddcb]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;background:#f472b6;border-radius:50%;box-shadow:0 0 6px #f472b6;cursor:pointer;height:12px;margin-top:-4px;width:12px}input[type=range][data-v-7113ddcb]::-webkit-slider-runnable-track{background:#a21caf;border-radius:2px;height:4px;width:100%}input[type=range][data-v-7113ddcb]::-moz-range-thumb{background:#f472b6;border:none;border-radius:50%;box-shadow:0 0 6px #f472b6;cursor:pointer;height:12px;width:12px}input[type=range][data-v-7113ddcb]::-moz-range-track{background:#a21caf;border-radius:2px;height:4px;width:100%}',""]),n.locals={},e.exports=n}}]);