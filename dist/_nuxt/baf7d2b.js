(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{326:function(e,t,r){"use strict";var n=r(2),o=r(219).trim;n({target:"String",proto:!0,forced:r(327)("trim")},{trim:function(){return o(this)}})},327:function(e,t,r){"use strict";var n=r(93).PROPER,o=r(4),l=r(220);e.exports=function(e){return o((function(){return!!l[e]()||"​᠎"!=="​᠎"[e]()||n&&l[e].name!==e}))}},357:function(e,t,r){var content=r(389);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(92).default)("2d3f81ca",content,!0,{sourceMap:!1})},388:function(e,t,r){"use strict";r(357)},389:function(e,t,r){var n=r(91)((function(i){return i[1]}));n.push([e.i,'.material-icons[data-v-0ea15906]{display:inline-block;font-family:"Material Icons";font-size:24px;font-style:normal;font-weight:400;letter-spacing:normal;line-height:1;text-transform:none;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}',""]),n.locals={},e.exports=n},402:function(e,t,r){"use strict";r.r(t);r(35),r(36),r(41),r(70),r(71),r(51),r(16),r(31);var n=r(14),o=r(25),l=(r(69),r(26),r(153),r(326),r(94),r(74)),c=r(323),d=r(330),h=r(329);function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f={components:{Sidebar:c.a,PlayerBar:d.a},data:function(){return{searchQuery:"",searchResults:null,loading:!1,isPlayerReady:!1,pendingTrack:null,pendingPlaylist:null}},methods:v(v({},Object(l.c)(["setDeviceId"])),{},{handlePlayerReady:function(e){console.log("Player is ready in search page:",e),this.isPlayerReady=!0,this.setDeviceId(e),this.pendingTrack?(this.playTrack(this.pendingTrack),this.pendingTrack=null):this.pendingPlaylist&&(this.playPlaylist(this.pendingPlaylist),this.pendingPlaylist=null)},handlePlayerNotReady:function(){console.log("Player is not ready in search page"),this.isPlayerReady=!1},handlePlayerStateChanged:function(e){console.log("Player state changed in search page:",e)},search:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.searchQuery.trim()){t.next=3;break}return e.searchResults=null,t.abrupt("return");case 3:return e.loading=!0,t.prev=4,t.next=7,Object(h.a)();case 7:if(r=t.sent){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,e.$axios.$get("https://api.spotify.com/v1/search?q=".concat(encodeURIComponent(e.searchQuery),"&type=track,artist,album,playlist&limit=20"),{headers:{Authorization:"Bearer ".concat(r)}});case 12:n=t.sent,e.searchResults=n,t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),console.error("Error searching:",t.t0);case 19:return t.prev=19,e.loading=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[4,16,19,22]])})))()},playTrack:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.isPlayerReady){r.next=4;break}return console.log("Player not ready, storing track for later:",e),t.pendingTrack=e,r.abrupt("return");case 4:return r.prev=4,r.next=7,Object(h.a)();case 7:if(n=r.sent,o=localStorage.getItem("spotify_device_id"),n&&o){r.next=12;break}return console.error("No token or device ID available"),r.abrupt("return");case 12:return console.log("Playing track:",e),r.next=15,t.$axios.$put("https://api.spotify.com/v1/me/player/play?device_id=".concat(o),{uris:[e]},{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 15:r.next=32;break;case 17:if(r.prev=17,r.t0=r.catch(4),console.error("Error playing track:",r.t0),401!==(null===(l=r.t0.response)||void 0===l?void 0:l.status)){r.next=32;break}return r.prev=21,r.next=24,Object(h.a)();case 24:return r.next=26,t.playTrack(e);case 26:r.next=32;break;case 28:r.prev=28,r.t1=r.catch(21),console.error("Error refreshing token:",r.t1),t.$router.push("/login");case 32:case"end":return r.stop()}}),r,null,[[4,17],[21,28]])})))()},playPlaylist:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.isPlayerReady){r.next=4;break}return console.log("Player not ready, storing playlist for later:",e),t.pendingPlaylist=e,r.abrupt("return");case 4:return r.prev=4,r.next=7,Object(h.a)();case 7:if(n=r.sent,o=localStorage.getItem("spotify_device_id"),n&&o){r.next=12;break}return console.error("No token or device ID available"),r.abrupt("return");case 12:return console.log("Playing playlist:",e),r.next=15,t.$axios.$put("https://api.spotify.com/v1/me/player/play?device_id=".concat(o),{context_uri:e},{headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}});case 15:r.next=32;break;case 17:if(r.prev=17,r.t0=r.catch(4),console.error("Error playing playlist:",r.t0),401!==(null===(l=r.t0.response)||void 0===l?void 0:l.status)){r.next=32;break}return r.prev=21,r.next=24,Object(h.a)();case 24:return r.next=26,t.playPlaylist(e);case 26:r.next=32;break;case 28:r.prev=28,r.t1=r.catch(21),console.error("Error refreshing token:",r.t1),t.$router.push("/login");case 32:case"end":return r.stop()}}),r,null,[[4,17],[21,28]])})))()},handleSearch:function(){var e=this;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){e.search()}),300)}}),beforeDestroy:function(){this.searchTimeout&&clearTimeout(this.searchTimeout)}},m=(r(388),r(49)),component=Object(m.a)(f,(function(){var e,t,n,o=this,l=o._self._c;return l("div",{staticClass:"flex h-screen bg-black"},[l("Sidebar"),o._v(" "),l("main",{staticClass:"flex-1 overflow-y-auto"},[l("div",{staticClass:"p-4 bg-gray-900"},[l("div",{staticClass:"relative"},[l("input",{directives:[{name:"model",rawName:"v-model",value:o.searchQuery,expression:"searchQuery"}],staticClass:"w-full px-4 py-2 bg-gray-800 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-green-500",attrs:{type:"text",placeholder:"Rechercher des artistes, des chansons ou des playlists..."},domProps:{value:o.searchQuery},on:{input:[function(e){e.target.composing||(o.searchQuery=e.target.value)},o.handleSearch]}}),o._v(" "),o._m(0)])]),o._v(" "),o.searchResults?l("div",{staticClass:"p-8"},[l("h2",{staticClass:"text-2xl font-bold mb-4"},[o._v("Résultats de recherche")]),o._v(" "),null!==(e=o.searchResults.artists)&&void 0!==e&&e.items.length?l("div",{staticClass:"mb-8"},[l("h3",{staticClass:"text-xl font-semibold mb-4"},[o._v("Artistes")]),o._v(" "),l("div",{staticClass:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},o._l(o.searchResults.artists.items,(function(e){var t;return l("div",{key:e.id,staticClass:"bg-gray-800 p-4 rounded-lg hover:bg-gray-700 transition duration-200 ease-in-out transform hover:scale-105"},[l("img",{staticClass:"w-full h-40 object-cover mb-2 rounded-full",attrs:{src:(null===(t=e.images[0])||void 0===t?void 0:t.url)||r(316),alt:e.name}}),o._v(" "),l("h3",{staticClass:"text-lg font-semibold text-center"},[o._v(o._s(e.name))]),o._v(" "),l("p",{staticClass:"text-gray-400 text-sm text-center"},[o._v("Artiste")])])})),0)]):o._e(),o._v(" "),null!==(t=o.searchResults.tracks)&&void 0!==t&&t.items.length?l("div",{staticClass:"mb-8"},[l("h3",{staticClass:"text-xl font-semibold mb-4"},[o._v("Chansons")]),o._v(" "),l("div",{staticClass:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},o._l(o.searchResults.tracks.items,(function(track){var e,t;return l("div",{key:track.id,staticClass:"bg-gray-800 p-4 rounded-lg hover:bg-gray-700 transition duration-200 ease-in-out transform hover:scale-105"},[l("img",{staticClass:"w-full h-40 object-cover mb-2 rounded",attrs:{src:(null===(e=track.album.images[0])||void 0===e?void 0:e.url)||r(316),alt:track.name}}),o._v(" "),l("h3",{staticClass:"text-lg font-semibold"},[o._v(o._s(track.name))]),o._v(" "),l("p",{staticClass:"text-gray-400 text-sm"},[o._v(o._s(null===(t=track.artists[0])||void 0===t?void 0:t.name))]),o._v(" "),l("button",{staticClass:"mt-2 w-full bg-green-500 hover:bg-green-600 text-white py-1 px-2 rounded",attrs:{disabled:!o.isPlayerReady},on:{click:function(e){return o.playTrack(track.uri)}}},[o._v("\n              "+o._s(o.isPlayerReady?"Écouter":"Chargement...")+"\n            ")])])})),0)]):o._e(),o._v(" "),null!==(n=o.searchResults.playlists)&&void 0!==n&&n.items.length?l("div",{staticClass:"mb-8"},[l("h3",{staticClass:"text-xl font-semibold mb-4"},[o._v("Playlists")]),o._v(" "),l("div",{staticClass:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},o._l(o.searchResults.playlists.items,(function(e){var t;return l("div",{key:e.id,staticClass:"bg-gray-800 p-4 rounded-lg hover:bg-gray-700 transition duration-200 ease-in-out transform hover:scale-105"},[l("img",{staticClass:"w-full h-40 object-cover mb-2 rounded",attrs:{src:(null===(t=e.images[0])||void 0===t?void 0:t.url)||r(316),alt:e.name}}),o._v(" "),l("h3",{staticClass:"text-lg font-semibold"},[o._v(o._s(e.name))]),o._v(" "),l("p",{staticClass:"text-gray-400 text-sm"},[o._v("Par "+o._s(e.owner.display_name))]),o._v(" "),l("button",{staticClass:"mt-2 w-full bg-green-500 hover:bg-green-600 text-white py-1 px-2 rounded",attrs:{disabled:!o.isPlayerReady},on:{click:function(t){return o.playPlaylist(e.uri)}}},[o._v("\n              "+o._s(o.isPlayerReady?"Écouter":"Chargement...")+"\n            ")])])})),0)]):o._e()]):o._e()]),o._v(" "),l("PlayerBar",{on:{"player-ready":o.handlePlayerReady,"player-not-ready":o.handlePlayerNotReady,"player-state-changed":o.handlePlayerStateChanged}})],1)}),[function(){var e=this._self._c;return e("span",{staticClass:"absolute right-4 top-2 text-gray-400"},[e("i",{staticClass:"material-icons"},[this._v("search")])])}],!1,null,"0ea15906",null);t.default=component.exports}}]);